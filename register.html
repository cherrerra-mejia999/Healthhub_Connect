
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Healthub Connect</title>
    <style>
        body { background: #f2f2f2; margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; font-family: Arial, sans-serif; }
        .box { width: 100%; max-width: 500px; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; margin-bottom: 25px; color: #4b3fa6; }
        label { display: block; margin-bottom: 5px; font-weight: 600; }
        input, button { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 4px; box-sizing: border-box; }
        input { border: 1px solid #aaa; }
        button { background: #4b3fa6; color: #fff; border: none; font-weight: bold; cursor: pointer; }
        .errors { background: #ffe6e6; border: 1px solid #ff9b9b; padding: 15px; margin-bottom: 20px; border-radius: 4px; color: #c00; }
        .success { background: #e6ffe6; border: 1px solid #9bff9b; padding: 15px; margin-bottom: 20px; border-radius: 4px; color: #060; }
    </style>
</head>
<body>
    <div class="box">
        <h2>Create Healthub Account</h2>
        <div id="message"></div>
        <form id="registerForm">
            <label>First Name *</label>
            <input type="text" id="first_name" required>
            <label>Last Name *</label>
            <input type="text" id="last_name" required>
            <label>Email *</label>
            <input type="email" id="email" required>
            <label>Username *</label>
            <input type="text" id="username" required>
            <label>Password *</label>
            <input type="password" id="password" required minlength="6">
            <button type="submit">Create Account</button>
            <p>Already have an account? <a href="signin.html">Sign in here</a></p>
        </form>
    </div>

    <script>
        // Simple Supabase initialization that waits for everything to be ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, waiting for Supabase...');
            
            // Wait a bit to ensure Supabase CDN is loaded
            setTimeout(function() {
                try {
                    const supabaseUrl = 'https://hbtgwzneuhdqlmriwvje.supabase.co';
                    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhidGd3em5ldWhkcWxtcml3dmplIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDI5MTQsImV4cCI6MjA3NTkxODkxNH0.1v1OLYSEPRBKaZWQu1sJo8DoRzYePfdc7Zcs8i8TF78';
                    
                    // Check if Supabase is available
                    if (typeof supabaseJs === 'undefined' && typeof window.supabase === 'undefined') {
                        // Load Supabase dynamically
                        const script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js';
                        script.onload = function() {
                            initializeApp();
                        };
                        document.head.appendChild(script);
                    } else {
                        initializeApp();
                    }
                    
                    function initializeApp() {
                        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                        console.log('✅ Supabase initialized!');
                        
                        document.getElementById('registerForm').addEventListener('submit', async (e) => {
                            e.preventDefault();
                            
                            const formData = {
                                first_name: document.getElementById('first_name').value.trim(),
                                last_name: document.getElementById('last_name').value.trim(),
                                email: document.getElementById('email').value.trim(),
                                username: document.getElementById('username').value.trim(),
                                password: document.getElementById('password').value
                            };

                            if (!formData.first_name || !formData.last_name || !formData.email || !formData.username || !formData.password) {
                                showMessage('Please fill in all required fields.', 'error');
                                return;
                            }

                            try {
                                const { data, error } = await supabase.auth.signUp({
                                    email: formData.email,
                                    password: formData.password,
                                    options: {
                                        data: {
                                            username: formData.username,
                                            first_name: formData.first_name,
                                            last_name: formData.last_name
                                        }
                                    }
                                });

                                if (error) throw error;
                                
                                showMessage('✅ Account created successfully! Please check your email.', 'success');
                                
                                setTimeout(() => {
                                    window.location.href = 'signin.html';
                                }, 3000);

                            } catch (error) {
                                console.error('Error:', error);
                                showMessage('❌ ' + error.message, 'error');
                            }
                        });
                    }
                    
                } catch (error) {
                    console.error('Initialization error:', error);
                    showMessage('Error loading page. Please refresh.', 'error');
                }
            }, 100);
        });

        function showMessage(message, type) {
            document.getElementById('message').innerHTML = message;
            document.getElementById('message').className = type === 'error' ? 'errors' : 'success';
        }
    </script>
</body>
</html>




